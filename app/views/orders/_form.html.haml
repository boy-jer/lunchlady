- freeze_user_id    ||= false
- hide_link_to_meal ||= false
- orderer_str = case when freeze_user_id && user_signed_in? && (@order.user_id == current_user.id) then " for you" when freeze_user_id && @order.user then " for " + @order.user.name else "" end

= form_for [@meal, @order] do |f|
  %fieldset.order
    = f.error_messages
    %legend== Order#{orderer_str} from #{@meal.restaurant_name} on #{link_to_rsrc @meal}
    - if freeze_user_id
      = f.hidden_field   :user_id
    - else
      .form_input
        = f.label      :user_id
        = f.select("user_id", User.alphabetically.map{|u| [ u.name, u.id ] })
    .form_input
      = f.label      :description
      = f.text_area  :description
    .form_input
      = f.label      :price
      = f.text_field :price
    .buttons
      = f.submit
      .right
        - unless hide_link_to_meal
          = link_to "View all orders for this meal", @meal
        - unless @order.new_record?
          = raw("&middot;") unless hide_link_to_meal
          = link_to "Delete this order", [@meal, @order], :confirm => 'Are you sure?', :method => :delete 
